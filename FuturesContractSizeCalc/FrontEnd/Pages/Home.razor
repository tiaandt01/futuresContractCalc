@* @page "/"

<PageTitle>Home</PageTitle>

<h1>Hello, world!</h1>

Welcome to your new app.
 *@


@page "/"
@using FrontEnd.Models
@using FrontEnd.Services


<h1>Futures Risk Calculator</h1>

<div class="card">
    <label>Number of Contracts</label>
    <input type="number" min="1" step="1" @bind="ContractCount" />

    <label>Instrument</label>
    <select @bind="SelectedSymbol">
        <option value="">-- Select --</option>
        @foreach (var c in ContractService.Contracts)
        {
            <option value="@c.Symbol">@c.Symbol - @c.Name</option>
        }
    </select>

    <label>Points to Risk</label>
    <input type="number" step="0.01" @bind="PointsRisked" />

    <button @onclick="Calculate">Calculate</button>
</div>
@if (Result != null)
{
    <div class="result">
        <p><strong>Instrument:</strong> @Result.Name (@Result.Symbol)</p>
        <p><strong>Contracts:</strong> @ContractCount</p>
        <p><strong>Points:</strong> @PointsRisked</p>
        <p><strong>Ticks:</strong> @Ticks</p>
        <p><strong>Tick Size:</strong> @Result.TickSize</p>
        <p><strong>Tick Value:</strong> $@Result.TickValue</p>

        <hr />

        <p><strong>Risk / Contract:</strong> $@RiskPerContract</p>
        <p><strong>Total Risk:</strong> <strong>$@TotalRisk</strong></p>
    </div>
}


@code {
    string? SelectedSymbol;
    decimal PointsRisked;
    int ContractCount = 1;

    FuturesContract? Result;

    decimal Ticks;
    decimal RiskPerContract;
    decimal TotalRisk;

    void Calculate()
    {
        Result = ContractService.Contracts
            .FirstOrDefault(c => c.Symbol == SelectedSymbol);

        if (Result is null || ContractCount <= 0)
            return;

        Ticks = PointsRisked / Result.TickSize;
        RiskPerContract = Ticks * Result.TickValue;
        TotalRisk = RiskPerContract * ContractCount;
    }
}

